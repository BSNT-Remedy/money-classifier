{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Teachable Machine with p5.js</title>

  <script src="{% static 'main/p5.min.js' %}"></script>
  <script src="{% static 'main/ml5.min.js' %}"></script>
</head>
<body>
    <script>
        let video;
        let label = "waiting...";
        let classifier;

        let modelURL = "{% static 'main/model.json' %}";

        function setup() {
        createCanvas(320, 240);
        video = createCapture(VIDEO);
        video.size(320, 240);
        video.hide();

        classifier = ml5.imageClassifier(modelURL, video, () => {
            console.log("Model loaded!");
            classifyVideo();
        });
        }

        function classifyVideo() {
        if (classifier) classifier.classify(gotResults);
        }

        function draw() {
        background(0);
        image(video, 0, 0);
        textSize(24);
        textAlign(CENTER, CENTER);
        fill(255);
        text(label || "Waiting...", width / 2, height - 20);
        }

        function gotResults(error, results) {
        if (error) return console.error(error);
        label = results[0].label;
        classifyVideo();
        }
    </script>
</body>
</html>
